{"version":3,"sources":["common/config.js","common/speech.js","common/util.js","components/AthletesSettings.js","components/Footer.js","components/Header.js","components/VoiceSettings.js","components/App.js","hooks/useVoices.js","index.js"],"names":["LOCAL_STORAGE_KEY","DEFAULT_ATHLETES","map","athleteName","text","enabled","time","voiceCommands","voiceChanged","start","15","nextAthlete","10","5","2","1","0","speakCommand","command","args","voice","msg","SpeechSynthesisUtterance","lang","window","speechSynthesis","cancel","speak","toSeconds","ms","Math","round","AthletesSettings","athletes","onChange","athlete","athleteIndex","Form","Group","as","Row","controlId","Col","sm","InputGroup","Control","style","background","type","placeholder","value","e","a","ai","target","min","Append","ButtonGroup","toggle","ToggleButton","variant","name","checked","disabled","filter","length","icon","faSkullCrossbones","Footer","className","href","rel","faPaypal","faGithub","Header","Navbar","bg","Brand","faBiking","VoiceSettings","voices","Label","newVoiceURI","newVoice","find","v","voiceURI","Text","Button","padding","fontSize","border","onClick","undefined","setTimeout","location","reload","initialConfig","rawConfig","localStorage","getItem","config","JSON","parse","speechEnabled","startDelay","loadConfig","App","useState","state","setState","setStartDelay","setSpeechEnabled","setAthletes","getAthleteName","setVoices","updateVoices","getVoices","useEffect","onvoiceschanged","startsWith","useVoices","setVoiceURI","timeUntilNextChange","setTimeUntilNextChange","currentAthlete","setCurrentAthlete","setItem","stringify","useMemo","athletesWithIndex","index","slice","startTimeRef","useRef","prevTimeRef","pauseTimeRef","changeToNextAthlete","now","Date","current","useInterval","changeTime","secondsSinceStart","max","Container","Jumbotron","faArrowRight","faClock","ProgressBar","transform","faStop","faPlay","faPause","faForward","size","Card","Body","Check","label","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a61806b8.chunk.js","sourcesContent":["const LOCAL_STORAGE_KEY = \"config\";\n\nconst DEFAULT_START_DELAY = 0;\nconst DEFAULT_TIME_PER_ATHLETE = 30;\nconst DEFAULT_ATHLETE_NAMES = [\n  \"Amelia\",\n  \"Bowie\",\n  \"Coco\",\n  \"Dan\",\n  \"Emma\",\n  \"Finn\",\n];\nconst DEFAULT_SPEECH_ENABLED = false;\n\nconst DEFAULT_ATHLETES = DEFAULT_ATHLETE_NAMES.map((athleteName) => ({\n  text: athleteName,\n  enabled: true,\n  time: DEFAULT_TIME_PER_ATHLETE,\n}));\n\nexport function loadConfig() {\n  try {\n    const rawConfig = localStorage.getItem(LOCAL_STORAGE_KEY);\n    const config = JSON.parse(rawConfig);\n\n    return {\n      athletes: config.athletes || DEFAULT_ATHLETES,\n      speechEnabled: config.speechEnabled,\n      startDelay: config.startDelay,\n      voice: config.voice,\n    };\n  } catch {\n    return {\n      athletes: DEFAULT_ATHLETES,\n      speechEnabled: DEFAULT_SPEECH_ENABLED,\n      startDelay: DEFAULT_START_DELAY,\n    };\n  }\n}\n\nexport function saveConfig(config) {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(config));\n}\n","const voiceCommands = {\n  voiceChanged: () => \"Go faster!\",\n  start: () => \"Start\",\n  15: ({ nextAthlete }) => `${nextAthlete}. Get ready.`,\n  10: () => \"Change in 10\",\n  5: () => \"Five\",\n  2: () => \"Two\",\n  1: () => \"One\",\n  0: ({ nextAthlete }) => `Change to ${nextAthlete}`,\n};\n\nexport function speakCommand(command, args, voice) {\n  if (voiceCommands[command]) {\n    speak(voiceCommands[command](args), voice);\n  }\n}\n\nexport function speak(text, voice) {\n  const msg = new SpeechSynthesisUtterance();\n  msg.text = text;\n  msg.lang = \"en-US\";\n  msg.voice = voice;\n\n  window.speechSynthesis.cancel();\n  window.speechSynthesis.speak(msg);\n}\n","export function toSeconds(ms) {\n  return Math.round(ms / 1_000);\n}\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  ButtonGroup,\n  Col,\n  Form,\n  InputGroup,\n  Row,\n  ToggleButton,\n} from \"react-bootstrap\";\nimport { faSkullCrossbones } from \"@fortawesome/free-solid-svg-icons\";\n\nexport function AthletesSettings({ athletes, onChange }) {\n  return (\n    <>\n      <h3>Athletes</h3>\n\n      {athletes.map((athlete, athleteIndex) => (\n        <Form.Group\n          key={athleteIndex}\n          as={Row}\n          controlId={`athlete-${athleteIndex}`}\n        >\n          <Col sm={12}>\n            <InputGroup>\n              <Form.Control\n                style={{ background: !athlete.enabled && \"#6c757d80\" }}\n                type=\"text\"\n                placeholder=\"Name\"\n                value={athlete.text}\n                onChange={(e) =>\n                  onChange(\n                    athletes.map((a, ai) =>\n                      ai === athleteIndex ? { ...a, text: e.target.value } : a\n                    )\n                  )\n                }\n              />\n              <Form.Control\n                style={{ background: !athlete.enabled && \"#6c757d80\" }}\n                type=\"number\"\n                placeholder=\"Time (in seconds)\"\n                min={1}\n                value={athlete.time}\n                onChange={(e) =>\n                  onChange(\n                    athletes.map((a, ai) =>\n                      ai === athleteIndex ? { ...a, time: +e.target.value } : a\n                    )\n                  )\n                }\n              />\n              <InputGroup.Append>\n                <ButtonGroup toggle>\n                  <ToggleButton\n                    variant=\"outline-secondary\"\n                    type=\"checkbox\"\n                    name={`athlete-${athleteIndex}-enabled`}\n                    checked={!athlete.enabled}\n                    disabled={\n                      athlete.enabled &&\n                      athletes.filter((a) => a.enabled).length === 1\n                    }\n                    onChange={(e) =>\n                      onChange(\n                        athletes.map((a, ai) =>\n                          ai === athleteIndex\n                            ? { ...a, enabled: !e.target.checked }\n                            : a\n                        )\n                      )\n                    }\n                  >\n                    <FontAwesomeIcon icon={faSkullCrossbones} />\n                  </ToggleButton>\n                </ButtonGroup>\n              </InputGroup.Append>\n            </InputGroup>\n          </Col>\n        </Form.Group>\n      ))}\n    </>\n  );\n}\n","import { faGithub, faPaypal } from \"@fortawesome/free-brands-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport function Footer() {\n  return (\n    <footer className=\"text-muted mt-4 mb-2 text-center\">\n      <p>\n        <small>\n          Made with ♥ for{\" \"}\n          <a\n            href=\"https://www.wtrl.racing\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            WTRL\n          </a>{\" \"}\n          by{\" \"}\n          <a\n            href=\"https://zwiftpower.com/profile.php?z=1861132\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            Andi P&auml;tzold\n          </a>\n        </small>\n      </p>\n      <p>\n        <small>\n          <a\n            href=\"paypal.me/andipaetzold\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <FontAwesomeIcon icon={faPaypal} /> Donate via PayPal\n          </a>\n        </small>\n      </p>\n      <p>\n        <small>\n          <a\n            href=\"https://github.com/andipaetzold/tttt\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <FontAwesomeIcon icon={faGithub} /> GitHub\n          </a>\n        </small>\n      </p>\n    </footer>\n  );\n}\n","import { faBiking } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { Navbar } from \"react-bootstrap\";\n\nexport function Header() {\n  return (\n    <Navbar bg=\"light\" className=\"mb-2\">\n      <Navbar.Brand className=\"mx-auto\">\n        <FontAwesomeIcon icon={faBiking} /> Team Time Trial Timer{\" \"}\n        <FontAwesomeIcon icon={faBiking} />\n      </Navbar.Brand>\n    </Navbar>\n  );\n}\n","import { Button, Form } from \"react-bootstrap\";\nimport { speakCommand } from \"../common/speech\";\n\nexport function VoiceSettings({ voices, voice, onChange }) {\n  const handleChange = (e) => {\n    const newVoiceURI = e.target.value;\n    const newVoice = voices.find((v) => v.voiceURI === newVoiceURI);\n\n    if (!newVoice) {\n      return;\n    }\n\n    speakCommand(\"voiceChanged\", {}, newVoice);\n    onChange(newVoice);\n  };\n  return (\n    <Form.Group controlId=\"voice\">\n      <Form.Label>Voice</Form.Label>\n      <Form.Control\n        as=\"select\"\n        onChange={handleChange}\n        value={voice?.voiceURI}\n        disabled={voices.length === 0}\n      >\n        {voices.length > 0 ? (\n          voices.map((v) => (\n            <option key={v.voiceURI} value={v.voiceURI}>\n              {v.name}\n            </option>\n          ))\n        ) : (\n          <option key=\"default\">Default</option>\n        )}\n      </Form.Control>\n      <Form.Text>\n        If the voice output does not work anymore, click{\" \"}\n        <Button\n          style={{\n            padding: 0,\n            fontSize: \"100%\",\n            border: \"none\",\n          }}\n          variant=\"link\"\n          onClick={() => {\n            onChange(undefined);\n\n            // make sure the changes are saved to local storage\n            setTimeout(() => {\n              window.location.reload();\n            }, 0);\n          }}\n        >\n          here\n        </Button>{\" \"}\n        to reset the app and keep the default voice.\n      </Form.Text>\n    </Form.Group>\n  );\n}\n","import { faClock } from \"@fortawesome/free-regular-svg-icons\";\nimport {\n  faArrowRight,\n  faForward,\n  faPause,\n  faPlay,\n  faStop,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport useInterval from \"@use-it/interval\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  Button,\n  Card,\n  Container,\n  Form,\n  Jumbotron,\n  ProgressBar,\n} from \"react-bootstrap\";\nimport { loadConfig, saveConfig } from \"../common/config\";\nimport { speakCommand } from \"../common/speech\";\nimport { toSeconds } from \"../common/util\";\nimport { useVoices } from \"../hooks/useVoices\";\nimport { AthletesSettings } from \"./AthletesSettings\";\nimport { Footer } from \"./Footer\";\nimport { Header } from \"./Header\";\nimport { VoiceSettings } from \"./VoiceSettings\";\n\nconst initialConfig = loadConfig();\n\nexport default function App() {\n  const [state, setState] = useState(\"stopped\");\n\n  const [startDelay, setStartDelay] = useState(initialConfig.startDelay);\n  const [speechEnabled, setSpeechEnabled] = useState(\n    initialConfig.speechEnabled\n  );\n  const [athletes, setAthletes] = useState(initialConfig.athletes);\n\n  const getAthleteName = (athleteIndex) => {\n    if (athleteIndex === undefined) {\n      return \"\";\n    }\n\n    return athletes[athleteIndex].text || `Athlete ${athleteIndex + 1}`;\n  };\n\n  const voices = useVoices();\n  const [voiceURI, setVoiceURI] = useState(initialConfig.voice);\n  const voice = voices.find((v) => v.voiceURI === voiceURI);\n\n  const [timeUntilNextChange, setTimeUntilNextChange] = useState(0);\n  const [currentAthlete, setCurrentAthlete] = useState(undefined);\n\n  useEffect(() => {\n    saveConfig({ athletes, startDelay, speechEnabled, voice: voiceURI });\n  }, [athletes, startDelay, speechEnabled, voiceURI]);\n\n  const nextAthlete = useMemo(() => {\n    const athletesWithIndex = athletes.map((a, ai) => ({ ...a, index: ai }));\n\n    if (currentAthlete === undefined) {\n      return athletesWithIndex.find((a) => a.enabled).index;\n    }\n\n    return [\n      ...athletesWithIndex.slice(currentAthlete + 1),\n      ...athletesWithIndex,\n    ].filter((a) => a.enabled)[0].index;\n  }, [currentAthlete, athletes]);\n\n  const startTimeRef = useRef();\n  const prevTimeRef = useRef();\n  const pauseTimeRef = useRef();\n\n  const speak = (command) => {\n    if (!speechEnabled) {\n      return;\n    }\n    speakCommand(command, { nextAthlete: getAthleteName(nextAthlete) }, voice);\n  };\n\n  const changeToNextAthlete = () => {\n    setCurrentAthlete(nextAthlete);\n    setTimeUntilNextChange(athletes[nextAthlete].time);\n\n    const now = Date.now();\n    startTimeRef.current = now;\n    if (state === \"paused\") {\n      pauseTimeRef.current = now;\n    }\n  };\n\n  useInterval(() => {\n    if (state !== \"running\") {\n      return;\n    }\n\n    const changeTime =\n      currentAthlete === undefined ? startDelay : athletes[currentAthlete].time;\n\n    const now = Date.now();\n\n    const secondsSinceStart = toSeconds(now - startTimeRef.current);\n    const prevSecondsSinceStart = toSeconds(\n      prevTimeRef.current - startTimeRef.current\n    );\n\n    if (secondsSinceStart !== prevSecondsSinceStart) {\n      if (secondsSinceStart >= changeTime) {\n        speak(currentAthlete === undefined ? \"start\" : 0);\n        changeToNextAthlete();\n      } else {\n        speak(changeTime - secondsSinceStart);\n        setTimeUntilNextChange(Math.max(changeTime - secondsSinceStart, 0));\n      }\n    }\n\n    prevTimeRef.current = now;\n  }, 500);\n\n  const handleStart = () => {\n    const now = Date.now();\n\n    prevTimeRef.current = now;\n    startTimeRef.current = now;\n\n    setTimeUntilNextChange(startDelay > 0 ? startDelay : athletes[0].time);\n    setCurrentAthlete(startDelay > 0 ? undefined : nextAthlete);\n\n    setState(\"running\");\n  };\n\n  const handleStop = () => {\n    setState(\"stopped\");\n  };\n\n  const handlePause = () => {\n    setState(\"paused\");\n    pauseTimeRef.current = Date.now();\n  };\n\n  const handleResume = () => {\n    setState(\"running\");\n    startTimeRef.current =\n      Date.now() - (pauseTimeRef.current - startTimeRef.current);\n  };\n\n  return (\n    <>\n      <Header />\n\n      <Container>\n        <Jumbotron className=\"mb-2\">\n          {state !== \"stopped\" ? (\n            <>\n              <h1 className=\"text-center display-2\">\n                {currentAthlete === undefined\n                  ? \"Wait\"\n                  : getAthleteName(currentAthlete)}\n              </h1>\n\n              <h2 className=\"text-center display-5\">\n                <FontAwesomeIcon icon={faArrowRight} />{\" \"}\n                {getAthleteName(nextAthlete)}\n              </h2>\n\n              <h3 className=\"text-center display-6\">\n                <FontAwesomeIcon icon={faClock} /> {timeUntilNextChange}s\n              </h3>\n              <ProgressBar\n                style={{ transform: \"scaleX(-1)\", background: \"white\" }}\n                now={timeUntilNextChange}\n                max={\n                  currentAthlete === undefined\n                    ? startDelay\n                    : athletes[currentAthlete].time\n                }\n              />\n\n              <div className=\"mt-4 text-center\">\n                <Button variant=\"danger\" className=\"mr-1\" onClick={handleStop}>\n                  <FontAwesomeIcon icon={faStop} /> Stop\n                </Button>\n                {state === \"paused\" ? (\n                  <Button\n                    variant=\"info\"\n                    className=\"mr-1\"\n                    onClick={handleResume}\n                  >\n                    <FontAwesomeIcon icon={faPlay} /> Resume\n                  </Button>\n                ) : (\n                  <Button variant=\"info\" className=\"mr-1\" onClick={handlePause}>\n                    <FontAwesomeIcon icon={faPause} /> Pause\n                  </Button>\n                )}\n\n                <Button variant=\"warning\" onClick={changeToNextAthlete}>\n                  <FontAwesomeIcon icon={faForward} /> Skip\n                </Button>\n              </div>\n            </>\n          ) : (\n            <div className=\"text-center\">\n              <Button variant=\"primary\" onClick={handleStart} size=\"lg\">\n                <FontAwesomeIcon icon={faPlay} /> Start\n              </Button>\n            </div>\n          )}\n        </Jumbotron>\n\n        <Card className=\"mb-2\">\n          <Card.Body>\n            <AthletesSettings athletes={athletes} onChange={setAthletes} />\n\n            <h3>Settings</h3>\n            <Form.Group controlId=\"startDelay\">\n              <Form.Label>Start Delay (in seconds)</Form.Label>\n              <Form.Control\n                type=\"number\"\n                value={startDelay}\n                onChange={(e) => setStartDelay(+e.target.value)}\n                min={0}\n              />\n            </Form.Group>\n\n            <Form.Group controlId=\"speechEnabled\">\n              <Form.Check\n                type=\"checkbox\"\n                label=\"Voice Output\"\n                checked={speechEnabled}\n                onChange={(e) => setSpeechEnabled(e.target.checked)}\n              />\n              <Form.Text>Voice Output is not supported on iOS</Form.Text>\n            </Form.Group>\n            <VoiceSettings\n              voices={voices}\n              voice={voice}\n              onChange={(v) => setVoiceURI(v?.voiceURI)}\n            />\n          </Card.Body>\n        </Card>\n\n        <Footer />\n      </Container>\n    </>\n  );\n}\n","import { useEffect, useState } from \"react\";\n\nexport function useVoices() {\n  const [voices, setVoices] = useState([]);\n\n  const updateVoices = () => {\n    setVoices(window.speechSynthesis.getVoices());\n  };\n\n  useEffect(() => {\n    if (typeof window.speechSynthesis === \"undefined\") {\n      return;\n    }\n\n    updateVoices();\n    window.speechSynthesis.onvoiceschanged = updateVoices;\n    return () => (window.speechSynthesis.onvoiceschanged = undefined);\n  }, []);\n\n  return voices.filter((voice) => voice.lang.startsWith(\"en-\"));\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}