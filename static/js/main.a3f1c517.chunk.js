(this.webpackJsonptttt=this.webpackJsonptttt||[]).push([[0],{34:function(e,t,n){"use strict";n.r(t);var c=n(5),a=n(0),r=n.n(a),i=n(10),o=n.n(i),s=n(17),l=n(8),d=n(7),u=n(19),h=n.n(u),j=n(43),b=n(37),O=n(38),f=n(46),x=n(23),p=n(45),v=n(44),m=n(39),g=n(22),y=n(40),w=n(41),S=n(42),k="config",C=["Amelia","Bowie","Coco","Dan","Emma","Finn"].map((function(e){return{text:e,enabled:!0,time:30}}));var I={voiceChanged:function(){return"Go faster!"},start:function(){return"Start"},15:function(e){var t=e.nextAthlete;return"".concat(t,". Get ready.")},10:function(){return"Change in 10"},5:function(){return"Five"},2:function(){return"Two"},1:function(){return"One"},0:function(e){var t=e.nextAthlete;return"Change to ".concat(t)}};function D(e,t,n){I[e]&&function(e,t){var n=new SpeechSynthesisUtterance;n.text=e,n.lang="en-US",n.voice=t,window.speechSynthesis.cancel(),window.speechSynthesis.speak(n)}(I[e](t),n)}var N=function(){try{var e=localStorage.getItem(k),t=JSON.parse(e);return{athletes:t.athletes||C,speechEnabled:t.speechEnabled,startDelay:t.startDelay,voice:t.voice}}catch(n){return{athletes:C,speechEnabled:false,startDelay:0}}}();function E(){var e=Object(a.useState)(0),t=Object(d.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(!1),o=Object(d.a)(i,2),u=o[0],C=o[1],I=Object(a.useState)(N.startDelay),E=Object(d.a)(I,2),T=E[0],G=E[1],z=Object(a.useState)(N.speechEnabled),R=Object(d.a)(z,2),U=R[0],M=R[1],B=Object(a.useState)(N.athletes),F=Object(d.a)(B,2),J=F[0],L=F[1],V=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],r=function(){c(window.speechSynthesis.getVoices())};return Object(a.useEffect)((function(){if("undefined"!==typeof window.speechSynthesis)return r(),window.speechSynthesis.onvoiceschanged=r,function(){return window.speechSynthesis.onvoiceschanged=void 0}}),[]),n.filter((function(e){return e.lang.startsWith("en-")}))}(),W=Object(a.useState)(N.voice),_=Object(d.a)(W,2),H=_[0],P=_[1],X=V.find((function(e){return e.voiceURI===H})),q=Object(a.useState)(0),K=Object(d.a)(q,2),Q=K[0],Y=K[1],Z=Object(a.useState)(void 0),$=Object(d.a)(Z,2),ee=$[0],te=$[1],ne=void 0!==ee?J[ee].text||"Athlete ".concat(ee+1):"";Object(a.useEffect)((function(){var e;e={athletes:J,startDelay:T,speechEnabled:U,voice:H},localStorage.setItem(k,JSON.stringify(e))}),[J,T,U,H]);var ce=Object(a.useMemo)((function(){var e=J.map((function(e,t){return Object(l.a)(Object(l.a)({},e),{},{index:t})}));return void 0===ee?e.find((function(e){return e.enabled})).index:[].concat(Object(s.a)(e.slice(ee+1)),Object(s.a)(e)).filter((function(e){return e.enabled}))[0].index}),[ee,J]),ae=J[ce].text||"Athlete ".concat(ce+1),re=Object(a.useRef)(),ie=function(e){U&&D(e,{nextAthlete:ae},X)};h()((function(){if(u){var e=void 0===ee?T:J[ee].time,t=Date.now(),c=A(t-n),a=A(re.current-n);Y(Math.max(e-c,0)),c!==a&&(c>=e?(U&&ie(void 0===ee?"start":0),te(ce),r(t)):U&&ie(e-c)),re.current=t}}),500);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(j.a,{bg:"light",className:"mb-2",children:Object(c.jsx)(b.a,{children:Object(c.jsx)(j.a.Brand,{children:"Team Time Trial Timer"})})}),Object(c.jsxs)(b.a,{children:[Object(c.jsxs)(O.a,{className:"mb-2",children:[u&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h1",{className:"text-center display-2",children:void 0===ee?"Wait":ne}),Object(c.jsxs)("h2",{className:"text-center display-5",children:["\ud83d\udd1c ",ae]}),Object(c.jsxs)("h3",{className:"text-center display-6",children:["\u23f1\ufe0f ",Q,"s"]}),Object(c.jsx)(f.a,{style:{transform:"scaleX(-1)",background:"white"},now:Q,max:void 0===ee?T:J[ee].time})]}),Object(c.jsx)("div",{className:"mt-4 text-center",children:u?Object(c.jsx)(x.a,{variant:"danger",onClick:function(){C(!1)},children:"Stop"}):Object(c.jsx)(x.a,{variant:"primary",onClick:function(){var e=Date.now();r(e),re.current=e,Y(T>0?T:J[0].time),te(T>0?void 0:ce),C(!0)},size:"lg",children:"Start"})})]}),Object(c.jsx)(p.a,{className:"mb-2",children:Object(c.jsxs)(p.a.Body,{children:[Object(c.jsx)("h3",{children:"Athletes"}),J.map((function(e,t){return Object(c.jsx)(v.a.Group,{as:m.a,controlId:"athlete-".concat(t),children:Object(c.jsx)(g.a,{sm:12,children:Object(c.jsxs)(y.a,{children:[Object(c.jsx)(v.a.Control,{style:{background:!e.enabled&&"#6c757d80"},type:"text",placeholder:"Name",value:e.text,onChange:function(e){return L(J.map((function(n,c){return c===t?Object(l.a)(Object(l.a)({},n),{},{text:e.target.value}):n})))}}),Object(c.jsx)(v.a.Control,{style:{background:!e.enabled&&"#6c757d80"},type:"number",placeholder:"Time (in seconds)",value:e.time,onChange:function(e){return L(J.map((function(n,c){return c===t?Object(l.a)(Object(l.a)({},n),{},{time:+e.target.value}):n})))}}),Object(c.jsx)(y.a.Append,{children:Object(c.jsx)(w.a,{toggle:!0,children:Object(c.jsx)(S.a,{variant:"outline-secondary",type:"checkbox",name:"athlete-".concat(t,"-enabled"),checked:!e.enabled,disabled:e.enabled&&1===J.filter((function(e){return e.enabled})).length,onChange:function(e){return L(J.map((function(n,c){return c===t?Object(l.a)(Object(l.a)({},n),{},{enabled:!e.target.checked}):n})))},children:"\u2620\ufe0f"})})})]})})},t)})),Object(c.jsx)("h3",{children:"Settings"}),Object(c.jsxs)(v.a.Group,{controlId:"startDelay",children:[Object(c.jsx)(v.a.Label,{children:"Start Delay (in seconds)"}),Object(c.jsx)(v.a.Control,{type:"number",value:T,onChange:function(e){return G(+e.target.value)},disabled:u,min:0})]}),Object(c.jsx)(v.a.Group,{controlId:"speechEnabled",children:Object(c.jsx)(v.a.Check,{type:"checkbox",label:"Voice Output",checked:U,onChange:function(e){return M(e.target.checked)}})}),Object(c.jsxs)(v.a.Group,{controlId:"voice",children:[Object(c.jsx)(v.a.Label,{children:"Voice"}),Object(c.jsx)(v.a.Control,{as:"select",onChange:function(e){return t=e.target.value,P(t),void D("voiceChanged",{},V.find((function(e){return e.voiceURI===t})));var t},value:H,disabled:0===V.length,children:V.length>0?V.map((function(e){return Object(c.jsx)("option",{value:e.voiceURI,children:e.name},e.voiceURI)})):Object(c.jsx)("option",{children:"Default"},"default")}),Object(c.jsxs)(v.a.Text,{children:["If the voice output does not work anymore, click"," ",Object(c.jsx)(x.a,{style:{padding:0,fontSize:"100%",border:"none"},variant:"link",onClick:function(){P(void 0),window.location.reload()},children:"here"})," ","to reset the app and keep the default voice."]})]})]})}),Object(c.jsxs)("footer",{className:"text-muted mb-2",children:[Object(c.jsx)("a",{href:"https://github.com/andipaetzold/tttt",rel:"noopener noreferrer",target:"_blank",children:"GitHub"})," ","| Made with \u2665 for"," ",Object(c.jsx)("a",{href:"https://www.wtrl.racing",rel:"noopener noreferrer",target:"_blank",children:"WTRL"})," ","by"," ",Object(c.jsx)("a",{href:"https://zwiftpower.com/profile.php?z=1861132",rel:"noopener noreferrer",target:"_blank",children:"Andi P\xe4tzold"})]})]})]})}function A(e){return Math.round(e/1e3)}n(33);o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(E,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.a3f1c517.chunk.js.map