(this.webpackJsonptttt=this.webpackJsonptttt||[]).push([[0],{35:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(0),r=n.n(a),i=n(10),o=n.n(i),s=n(18),l=n(8),u=n(7),d=n(20),j=n.n(d),h=n(41),b=n(42),O=n(46),f=n(24),x=n(45),p=n(44),v="config",m=["Amelia","Bowie","Coco","Dan","Emma","Finn"].map((function(e){return{text:e,enabled:!0,time:30}}));var g={voiceChanged:function(){return"Go faster!"},start:function(){return"Start"},15:function(e){var t=e.nextAthlete;return"".concat(t,". Get ready.")},10:function(){return"Change in 10"},5:function(){return"Five"},2:function(){return"Two"},1:function(){return"One"},0:function(e){var t=e.nextAthlete;return"Change to ".concat(t)}};function y(e,t,n){g[e]&&function(e,t){var n=new SpeechSynthesisUtterance;n.text=e,n.lang="en-US",n.voice=t,window.speechSynthesis.cancel(),window.speechSynthesis.speak(n)}(g[e](t),n)}function w(e){return Math.round(e/1e3)}var S=n(37),k=n(21),C=n(38),I=n(39),D=n(40);function N(e){var t=e.athletes,n=e.onChange;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h3",{children:"Athletes"}),t.map((function(e,a){return Object(c.jsx)(p.a.Group,{as:S.a,controlId:"athlete-".concat(a),children:Object(c.jsx)(k.a,{sm:12,children:Object(c.jsxs)(C.a,{children:[Object(c.jsx)(p.a.Control,{style:{background:!e.enabled&&"#6c757d80"},type:"text",placeholder:"Name",value:e.text,onChange:function(e){return n(t.map((function(t,n){return n===a?Object(l.a)(Object(l.a)({},t),{},{text:e.target.value}):t})))}}),Object(c.jsx)(p.a.Control,{style:{background:!e.enabled&&"#6c757d80"},type:"number",placeholder:"Time (in seconds)",value:e.time,onChange:function(e){return n(t.map((function(t,n){return n===a?Object(l.a)(Object(l.a)({},t),{},{time:+e.target.value}):t})))}}),Object(c.jsx)(C.a.Append,{children:Object(c.jsx)(I.a,{toggle:!0,children:Object(c.jsx)(D.a,{variant:"outline-secondary",type:"checkbox",name:"athlete-".concat(a,"-enabled"),checked:!e.enabled,disabled:e.enabled&&1===t.filter((function(e){return e.enabled})).length,onChange:function(e){return n(t.map((function(t,n){return n===a?Object(l.a)(Object(l.a)({},t),{},{enabled:!e.target.checked}):t})))},children:"\u2620\ufe0f"})})})]})})},a)}))]})}function E(){return Object(c.jsxs)("footer",{className:"text-muted mt-4 mb-2 text-center",children:[Object(c.jsx)("p",{children:Object(c.jsxs)("small",{children:["Made with \u2665 for"," ",Object(c.jsx)("a",{href:"https://www.wtrl.racing",rel:"noopener noreferrer",target:"_blank",children:"WTRL"})," ","by"," ",Object(c.jsx)("a",{href:"https://zwiftpower.com/profile.php?z=1861132",rel:"noopener noreferrer",target:"_blank",children:"Andi P\xe4tzold"})]})}),Object(c.jsx)("p",{children:Object(c.jsx)("small",{children:Object(c.jsx)("a",{href:"paypal.me/andipaetzold",rel:"noopener noreferrer",target:"_blank",children:"Donate via PayPal"})})}),Object(c.jsx)("p",{children:Object(c.jsx)("small",{children:Object(c.jsx)("a",{href:"https://github.com/andipaetzold/tttt",rel:"noopener noreferrer",target:"_blank",children:"GitHub"})})})]})}var T=n(43);function R(){return Object(c.jsx)(T.a,{bg:"light",className:"mb-2",children:Object(c.jsx)(T.a.Brand,{className:"mx-auto",children:"Team Time Trial Timer"})})}function A(e){var t=e.voices,n=e.voice,a=e.onChange;return Object(c.jsxs)(p.a.Group,{controlId:"voice",children:[Object(c.jsx)(p.a.Label,{children:"Voice"}),Object(c.jsx)(p.a.Control,{as:"select",onChange:function(e){var n=e.target.value,c=t.find((function(e){return e.voiceURI===n}));c&&(y("voiceChanged",{},c),a(c))},value:null===n||void 0===n?void 0:n.voiceURI,disabled:0===t.length,children:t.length>0?t.map((function(e){return Object(c.jsx)("option",{value:e.voiceURI,children:e.name},e.voiceURI)})):Object(c.jsx)("option",{children:"Default"},"default")}),Object(c.jsxs)(p.a.Text,{children:["If the voice output does not work anymore, click"," ",Object(c.jsx)(f.a,{style:{padding:0,fontSize:"100%",border:"none"},variant:"link",onClick:function(){a(void 0),setTimeout((function(){window.location.reload()}),0)},children:"here"})," ","to reset the app and keep the default voice."]})]})}var U=function(){try{var e=localStorage.getItem(v),t=JSON.parse(e);return{athletes:t.athletes||m,speechEnabled:t.speechEnabled,startDelay:t.startDelay,voice:t.voice}}catch(n){return{athletes:m,speechEnabled:false,startDelay:0}}}();function z(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(U.startDelay),o=Object(u.a)(i,2),d=o[0],m=o[1],g=Object(a.useState)(U.speechEnabled),S=Object(u.a)(g,2),k=S[0],C=S[1],I=Object(a.useState)(U.athletes),D=Object(u.a)(I,2),T=D[0],z=D[1],G=function(e){return void 0===e?"":T[e].text||"Athlete ".concat(e+1)},F=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],r=function(){c(window.speechSynthesis.getVoices())};return Object(a.useEffect)((function(){if("undefined"!==typeof window.speechSynthesis)return r(),window.speechSynthesis.onvoiceschanged=r,function(){return window.speechSynthesis.onvoiceschanged=void 0}}),[]),n.filter((function(e){return e.lang.startsWith("en-")}))}(),M=Object(a.useState)(U.voice),B=Object(u.a)(M,2),J=B[0],V=B[1],_=F.find((function(e){return e.voiceURI===J})),L=Object(a.useState)(0),P=Object(u.a)(L,2),W=P[0],H=P[1],X=Object(a.useState)(void 0),q=Object(u.a)(X,2),K=q[0],Q=q[1];Object(a.useEffect)((function(){var e;e={athletes:T,startDelay:d,speechEnabled:k,voice:J},localStorage.setItem(v,JSON.stringify(e))}),[T,d,k,J]);var Y=Object(a.useMemo)((function(){var e=T.map((function(e,t){return Object(l.a)(Object(l.a)({},e),{},{index:t})}));return void 0===K?e.find((function(e){return e.enabled})).index:[].concat(Object(s.a)(e.slice(K+1)),Object(s.a)(e)).filter((function(e){return e.enabled}))[0].index}),[K,T]),Z=Object(a.useRef)(),$=Object(a.useRef)(),ee=function(e){k&&y(e,{nextAthlete:G(Y)},_)};j()((function(){if(n){var e=void 0===K?d:T[K].time,t=Date.now(),c=w(t-Z.current);c!==w($.current-Z.current)&&(c>=e?(ee(void 0===K?"start":0),Q(Y),Z.current=Date.now(),H(T[Y].time)):(ee(e-c),H(Math.max(e-c,0)))),$.current=t}}),500);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(R,{}),Object(c.jsxs)(h.a,{children:[Object(c.jsxs)(b.a,{className:"mb-2",children:[n&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h1",{className:"text-center display-2",children:void 0===K?"Wait":G(K)}),Object(c.jsxs)("h2",{className:"text-center display-5",children:["\ud83d\udd1c ",G(Y)]}),Object(c.jsxs)("h3",{className:"text-center display-6",children:["\u23f1\ufe0f ",W,"s"]}),Object(c.jsx)(O.a,{style:{transform:"scaleX(-1)",background:"white"},now:W,max:void 0===K?d:T[K].time})]}),Object(c.jsx)("div",{className:"mt-4 text-center",children:n?Object(c.jsx)(f.a,{variant:"danger",onClick:function(){r(!1)},children:"Stop"}):Object(c.jsx)(f.a,{variant:"primary",onClick:function(){var e=Date.now();$.current=e,Z.current=e,H(d>0?d:T[0].time),Q(d>0?void 0:Y),r(!0)},size:"lg",children:"Start"})})]}),Object(c.jsx)(x.a,{className:"mb-2",children:Object(c.jsxs)(x.a.Body,{children:[Object(c.jsx)(N,{athletes:T,onChange:z}),Object(c.jsx)("h3",{children:"Settings"}),Object(c.jsxs)(p.a.Group,{controlId:"startDelay",children:[Object(c.jsx)(p.a.Label,{children:"Start Delay (in seconds)"}),Object(c.jsx)(p.a.Control,{type:"number",value:d,onChange:function(e){return m(+e.target.value)},disabled:n,min:0})]}),Object(c.jsxs)(p.a.Group,{controlId:"speechEnabled",children:[Object(c.jsx)(p.a.Check,{type:"checkbox",label:"Voice Output",checked:k,onChange:function(e){return C(e.target.checked)}}),Object(c.jsx)(p.a.Text,{children:"Voice Output is not supported on iOS"})]}),Object(c.jsx)(A,{voices:F,voice:_,onChange:function(e){return V(null===e||void 0===e?void 0:e.voiceURI)}})]})}),Object(c.jsx)(E,{})]})]})}n(34);o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(z,{})}),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.830abab0.chunk.js.map