(this.webpackJsonptttt=this.webpackJsonptttt||[]).push([[0],{115:function(e,t){},139:function(e,t,n){"use strict";n.r(t);n(98);var a,c=n(0),r=n.n(c),i=n(24),s=n.n(i),o=n(52),l=n(17),u=n(29),d=n(13),j=n(11),b=n(86),h=n.n(b),m=n(153),O=n(154),p=n(89),f=n(159),x=n(157),v=n(94),g=n(18),y=(a={},Object(g.a)(a,600,(function(){return"10 minutes"})),Object(g.a)(a,300,(function(){return"5 minutes"})),Object(g.a)(a,180,(function(){return"3 minutes"})),Object(g.a)(a,120,(function(){return"2 minutes"})),Object(g.a)(a,60,(function(){return"1 minute"})),Object(g.a)(a,30,(function(){return"30 seconds"})),Object(g.a)(a,15,(function(e){var t=e.nextAthlete;return"".concat(t,". Get ready.")})),Object(g.a)(a,10,(function(e){return e.started?"Change in 10":"Start in 10"})),Object(g.a)(a,5,(function(){return"Five"})),Object(g.a)(a,2,(function(){return"Two"})),Object(g.a)(a,1,(function(){return"One"})),Object(g.a)(a,0,(function(e){var t=e.nextAthlete;return e.started?"Change to ".concat(t):"Let's go"})),Object(g.a)(a,"skip",(function(e){var t=e.nextAthlete;return"Go ".concat(t,"!")})),a);function k(e,t){y[e]&&function(e){if(!w)return;var t=new window.SpeechSynthesisUtterance;t.text=e,t.lang="en-US",window.speechSynthesis.cancel(),window.speechSynthesis.speak(t)}(y[e](t))}var w="speechSynthesis"in window&&"SpeechSynthesisUtterance"in window,S=["Amelia","Bowie","Coco","Dan","Emma","Finn","Grace","Henry","Irene","Jack"],N=w,C="config",T=S.slice(0,6).map((function(e){return{text:e,enabled:!0,time:30}}));function A(e){var t=Math.floor(e/60),n=Math.floor(e-60*t);return 0===t?"".concat(n,"s"):"".concat(t,":").concat(n.toString().padStart(2,"0"),"min")}var D=n(25),E=n.n(D),P=n(43),R="wakeLock"in navigator;var z=n(149),L=n(90),M=n(150),_=n(151),F=n(152),U=n(20),B=n(155),I=n(148),G=n(2);function J(e){var t=e.command,n=Object(c.useState)("DEFAULT"),a=Object(u.a)(n,2),r=a[0],i=a[1],s=Object(c.useRef)(void 0),o=function(){var e=Object(P.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H();case 3:if(!e.sent){e.next=9;break}navigator.clipboard.writeText(t),s.current&&(clearTimeout(s.current),s.current=void 0),i("SUCCESS"),e.next=10;break;case 9:i("NOT_SUPPORTED");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),Object(U.a)(e.t0),i("ERROR");case 16:return e.prev=16,s.current=setTimeout((function(){return i("DEFAULT")}),5e3),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,12,16,19]])})));return function(){return e.apply(this,arguments)}}();return Object(G.jsx)(B.a,{placement:"right",overlay:Object(G.jsx)(I.a,{id:"tooltip-copy-athletes",children:W(r)}),children:Object(G.jsx)(p.a,{variant:"outline-link",size:"sm",className:"m-0 p-0 border-0",onClick:o,children:Object(G.jsx)(j.a,{icon:d.d})})})}function W(e){switch(e){case"SUCCESS":return"Copied!";case"ERROR":return"Could not copy command.";case"NOT_SUPPORTED":return"Your browser doesn't allow copying the Dsiscord command.";default:return"Copy Discord Bot command"}}function H(){return q.apply(this,arguments)}function q(){return(q=Object(P.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("permissions"in navigator){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,navigator.permissions.query({name:"clipboard-write"});case 4:return t=e.sent,e.abrupt("return","granted"===t.state);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){var t=e.athletes,n=e.onChange,a=e.state,c="!t config athletes ".concat(t.map((function(e){return"".concat(e.text.trim().replaceAll(" ","_").replaceAll(" ","_"),":").concat(e.time)})).join(" ")),r=function(e){return"stopped"===a||t[e].enabled?"#fff":"#6c757d80"};return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("h2",{className:"mb-3",children:["Athletes ",Object(G.jsx)(J,{command:c})]}),t.map((function(e,c){return Object(G.jsx)(x.a.Group,{as:z.a,controlId:"athlete-".concat(c),children:Object(G.jsx)(L.a,{sm:12,children:Object(G.jsxs)(M.a,{children:[Object(G.jsx)(x.a.Control,{style:{background:r(c)},type:"text",placeholder:"Name",value:e.text,onChange:function(e){return n(t.map((function(t,n){return n===c?Object(l.a)(Object(l.a)({},t),{},{text:e.target.value}):t})))}}),Object(G.jsx)(x.a.Control,{style:{background:r(c)},type:"number",placeholder:"Time (in seconds)",min:5,step:5,value:e.time,onChange:function(e){return n(t.map((function(t,n){return n===c?Object(l.a)(Object(l.a)({},t),{},{time:+e.target.value}):t})))}}),"stopped"!==a&&Object(G.jsx)(_.a,{toggle:!0,as:M.a.Append,children:Object(G.jsx)(F.a,{variant:"outline-secondary",type:"checkbox",name:"athlete-".concat(c,"-enabled"),checked:!e.enabled,disabled:e.enabled&&1===t.filter((function(e){return e.enabled})).length,value:e.text,onChange:function(e){return n(t.map((function(t,n){return n===c?Object(l.a)(Object(l.a)({},t),{},{enabled:!e.target.checked}):t})))},children:Object(G.jsx)(j.a,{icon:d.j})})}),"stopped"===a&&Object(G.jsx)(M.a.Append,{children:Object(G.jsx)(p.a,{variant:"danger",disabled:1===t.length,onClick:function(){return n(t.filter((function(e,t){return t!==c})))},children:Object(G.jsx)(j.a,{icon:d.l})})})]})})},c)})),"stopped"===a&&Object(G.jsxs)(p.a,{variant:"light",block:!0,onClick:function(){var e;n([].concat(Object(o.a)(t),[{text:null!==(e=S[t.length])&&void 0!==e?e:"",time:30,enabled:!0}]))},children:[Object(G.jsx)(j.a,{icon:d.i})," Add athlete"]})]})}var Y=n(91),K=n(160);function Q(e){var t=e.totalTime,n=e.timePassed;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("h3",{className:"text-center display-6",children:[Object(G.jsx)(j.a,{icon:Y.a})," ",A(t-n)]}),Object(G.jsx)(K.a,{style:{transform:"scaleX(-1)",background:"white"},now:Math.floor(t-n),max:t})]})}var V=n(161),Z=n.p+"static/media/discord.3372aeeb.svg",$=n.p+"static/media/discordMark.d2c3bfa7.svg";function ee(){return Object(G.jsxs)(V.a,{variant:"info",children:[Object(G.jsx)(V.a.Heading,{children:"Discord Bot"}),Object(G.jsxs)(z.a,{children:[Object(G.jsxs)(L.a,{xs:12,sm:4,md:2,children:[Object(G.jsx)("img",{src:Z,alt:"Discord Logo",className:"d-block d-sm-none"}),Object(G.jsx)("img",{src:$,alt:"Discord Logo",className:"d-none d-sm-block"})]}),Object(G.jsxs)(L.a,{xs:12,sm:8,md:10,children:[Object(G.jsxs)("p",{className:"mt-2",children:["No need to run the Web App on a rider's computer and mess around with the audio setup. Just add the TTT-Timer Discord Bot to your server and type ",Object(G.jsx)("code",{children:"!t help"})," for details on how to use it. After starting the timer, it will appear as a user within your call and coach you through the race."]}),Object(G.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(G.jsx)("a",{className:"btn btn-light",target:"_blank",rel:"noopener noreferrer",href:"https://andipaetzold.github.io/tttt-discord",children:"Documentation"}),Object(G.jsx)("a",{className:"btn btn-primary ml-2",target:"_blank",rel:"noopener noreferrer",href:"https://discord.com/api/oauth2/authorize?client_id=806979974594560060&permissions=3155968&scope=bot+applications.commands",children:"Install"})]})]})]})]})}var te=n(71);function ne(){return Object(G.jsxs)("footer",{className:"text-muted mt-4 mb-2 text-center",children:[Object(G.jsx)("p",{children:Object(G.jsxs)("small",{children:["Made with \u2665 for"," ",Object(G.jsx)("a",{href:"https://www.wtrl.racing",rel:"noopener noreferrer",target:"_blank",children:"WTRL"})," ","by"," ",Object(G.jsx)("a",{href:"mailto:tttt@andipaetzold.com",rel:"noopener noreferrer",target:"_blank",children:"Andi P\xe4tzold"})]})}),Object(G.jsx)("p",{children:Object(G.jsx)("small",{children:Object(G.jsxs)("a",{href:"https://paypal.me/andipaetzold",rel:"noopener noreferrer",target:"_blank",children:[Object(G.jsx)(j.a,{icon:te.b})," Donate via PayPal"]})})}),Object(G.jsx)("p",{children:Object(G.jsx)("small",{children:Object(G.jsxs)("a",{href:"https://github.com/andipaetzold/tttt",rel:"noopener noreferrer",target:"_blank",children:[Object(G.jsx)(j.a,{icon:te.a})," GitHub"]})})})]})}var ae=n(158);function ce(){return Object(G.jsx)(ae.a,{bg:"light",className:"mb-2",children:Object(G.jsxs)(ae.a.Brand,{className:"mx-auto",children:[Object(G.jsx)(j.a,{icon:d.b})," Team Time Trial Timer ",Object(G.jsx)(j.a,{icon:d.b})]})})}var re=function(){try{var e,t,n,a,c=null!==(e=localStorage.getItem(C))&&void 0!==e?e:"{}",r=JSON.parse(c);return{athletes:null!==(t=r.athletes)&&void 0!==t?t:T,speechEnabled:null!==(n=r.speechEnabled)&&void 0!==n?n:N,startDelay:null!==(a=r.startDelay)&&void 0!==a?a:0}}catch(i){return{athletes:T,speechEnabled:N,startDelay:0}}}();function ie(){var e=Object(c.useState)("stopped"),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(v.a)(),i=r.node,s=r.active,b=r.enter,g=r.exit;!function(e){var t=Object(c.useRef)(null);Object(c.useEffect)((function(){if(R&&e){var n=function(){var e=Object(P.a)(E.a.mark((function e(){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=t.current)||void 0===n?void 0:n.release();case 2:t.current=null;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(P.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("visible"===document.visibilityState){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n();case 5:return e.next=7,navigator.wakeLock.request("screen");case 7:t.current=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return a(),document.addEventListener("visibilitychange",a),function(){n(),document.removeEventListener("visibilitychange",a)}}}),[e])}("running"===n||"paused"===n);var y=Object(c.useState)(re.startDelay),S=Object(u.a)(y,2),N=S[0],T=S[1],D=Object(c.useState)(re.speechEnabled),z=Object(u.a)(D,2),L=z[0],M=z[1],_=Object(c.useState)(re.athletes),F=Object(u.a)(_,2),U=F[0],B=F[1],I=Object(c.useState)(void 0),W=Object(u.a)(I,2),H=W[0],q=W[1],Y=function(e){return void 0===e?"":U[e].text||"Athlete ".concat(e+1)};Object(c.useEffect)((function(){var e;e={athletes:U,startDelay:N,speechEnabled:L},localStorage.setItem(C,JSON.stringify(e))}),[U,N,L]);var K=Object(c.useMemo)((function(){var e=U.map((function(e,t){return Object(l.a)(Object(l.a)({},e),{},{index:t})}));return void 0===(null===H||void 0===H?void 0:H.currentAthlete)?e.find((function(e){return e.enabled})).index:[].concat(Object(o.a)(e.slice(H.currentAthlete+1)),Object(o.a)(e)).filter((function(e){return e.enabled}))[0].index}),[H,U]),V=function(e){L&&k(e,{nextAthlete:Y(K),started:void 0!==(null===H||void 0===H?void 0:H.currentAthlete)})},Z=Object(c.useRef)();h()((function(){var e=Date.now(),t=(e-Z.current)/1e3;if(Z.current=e,"running"===n&&void 0!==H){var a=Object(l.a)(Object(l.a)({},H),{},{timePassed:H.timePassed+t});if(Math.floor(H.timePassed)!==Math.floor(a.timePassed)){var c=a.totalTime-a.timePassed,r=Math.floor(Math.max(0,c));V(r.toString()),0===r&&(a={timePassed:-c,currentAthlete:K,totalTime:U[K].time})}q(a)}}),500);return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(ce,{}),Object(G.jsxs)(m.a,{children:[Object(G.jsxs)(O.a,{className:"pt-4 mb-2 position-relative d-flex flex-column align-items-center justify-content-center",ref:i,children:["stopped"!==n&&void 0!==H?Object(G.jsxs)("div",{className:"w-100",children:[Object(G.jsx)("h1",{className:"text-center display-2",children:void 0===H.currentAthlete?"Wait":Y(H.currentAthlete)}),Object(G.jsxs)("h2",{className:"text-center display-5",children:[Object(G.jsx)(j.a,{icon:d.a})," ",Y(K)]}),Object(G.jsx)(Q,{timePassed:H.timePassed,totalTime:H.totalTime}),Object(G.jsxs)("div",{className:"mt-4 text-center",children:["paused"===n?Object(G.jsxs)(p.a,{variant:"info",className:"mr-1",onClick:function(){a("running")},children:[Object(G.jsx)(j.a,{icon:d.h})," Resume"]}):Object(G.jsxs)(p.a,{variant:"info",className:"mr-1",onClick:function(){a("paused")},children:[Object(G.jsx)(j.a,{icon:d.g})," Pause"]}),Object(G.jsxs)(p.a,{variant:"warning",className:"mr-1",onClick:function(){V("skip"),q({timePassed:0,currentAthlete:K,totalTime:U[K].time})},children:[Object(G.jsx)(j.a,{icon:d.f})," ",void 0===H.currentAthlete?"Start now":"Skip"]}),"running"===n&&Object(G.jsxs)(p.a,{variant:"success",onClick:function(){H&&q(Object(l.a)(Object(l.a)({},H),{},{totalTime:H.totalTime+10}))},children:[Object(G.jsx)(j.a,{icon:d.i})," 10s"]})]})]}):Object(G.jsx)("div",{className:"text-center",children:Object(G.jsxs)(p.a,{variant:"primary",onClick:function(){var e=Date.now();Z.current=e,q({timePassed:0,totalTime:N>0?N:U[0].time,currentAthlete:N>0?void 0:K}),B((function(e){return e.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{enabled:!0})}))})),a("running")},size:"lg",children:[Object(G.jsx)(j.a,{icon:d.h})," Start"," ",N>0&&"in ".concat(A(N))]})}),Object(G.jsxs)("div",{className:"position-absolute",style:{right:16,bottom:16},children:["stopped"!==n&&Object(G.jsxs)(p.a,{variant:"danger",size:"sm",onClick:function(){a("stopped"),B((function(e){return e.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{enabled:!0})}))}))},children:[Object(G.jsx)(j.a,{icon:d.k})," Stop Timer"]}),w&&Object(G.jsx)(G.Fragment,{children:L?Object(G.jsx)(p.a,{className:"ml-2",size:"sm",variant:"secondary",onClick:function(){return M(!1)},children:Object(G.jsx)(j.a,{icon:d.n})}):Object(G.jsx)(p.a,{className:"ml-2",size:"sm",variant:"danger",onClick:function(){return M(!0)},children:Object(G.jsx)(j.a,{icon:d.m})})}),document.fullscreenEnabled&&Object(G.jsx)(G.Fragment,{children:s?Object(G.jsx)(p.a,{className:"ml-2",size:"sm",variant:"danger",onClick:g,children:Object(G.jsx)(j.a,{icon:d.c})}):Object(G.jsx)(p.a,{className:"ml-2",size:"sm",variant:"secondary",onClick:b,children:Object(G.jsx)(j.a,{icon:d.e})})})]}),Object(G.jsx)("div",{className:"mt-5",style:{maxWidth:"500px"},children:Object(G.jsx)(X,{athletes:U,onChange:B,state:n})})]}),Object(G.jsx)(f.a,{className:"mb-2",children:Object(G.jsxs)(f.a.Body,{children:[Object(G.jsx)("h3",{children:"Settings"}),Object(G.jsxs)(x.a.Group,{controlId:"startDelay",children:[Object(G.jsxs)(x.a.Label,{children:["Start Delay (in seconds) ",Object(G.jsx)(J,{command:"!t config delay ".concat(N)})]}),Object(G.jsx)(x.a.Control,{type:"number",value:N,onChange:function(e){return T(+e.target.value)},min:0,step:30,disabled:"stopped"!==n})]})]})}),Object(G.jsx)(ee,{}),Object(G.jsx)(ne,{})]})]})}n(138);var se=n(156),oe=n(93);se.a({dsn:"https://51f308cc68f84d17a534fbd3e08610c9@o260685.ingest.sentry.io/5685762",integrations:[new oe.a.BrowserTracing],tracesSampleRate:1,enabled:!0}),s.a.render(Object(G.jsx)(r.a.StrictMode,{children:Object(G.jsx)(ie,{})}),document.getElementById("root"))}},[[139,1,2]]]);
//# sourceMappingURL=main.e15f0279.chunk.js.map